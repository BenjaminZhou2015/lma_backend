(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{176:function(e,t,a){},251:function(e,t,a){e.exports=a(485)},485:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(4),c=a.n(r),o=(a(176),a(26)),l=a(27),u=a(29),s=a(28),d=a(85),m=a.n(d),p=a(86),f=a(120),h=a(33),g=a(132),y=a(215),b=a(487),E=a(488),v=a(489),S=(a(101),{background:"#0092ff",padding:"8px 0"}),I=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.data,t=[],a=[];e.map((function(e){return function(e){var a,n=Object(y.a)(t);try{for(n.s();!(a=n.n()).done;){if(e===a.value)return!0}}catch(i){n.e(i)}finally{n.f()}return!1}(e.locationID)||(t.push(e.locationID),a.push(t.length-1)),null}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,a.map((function(a){return i.a.createElement("div",null,i.a.createElement(v.a,{orientation:"middle",style:{color:"#333",fontWeight:"normal",fontSize:30,height:50,justifyContent:"center",alignItems:"center"}},"location:"+a),function(e,a){return i.a.createElement(b.a,{gutter:[16,24]},e.length<=0?"NO DB ENTRIES YET":e.sort((function(e,t){return e.machineType===t.machineType?e.sn<t.sn?-1:1:"washer"===e.machineType?-1:1})).map((function(e){return e.locationID==t[a]?i.a.createElement(E.a,{className:"gutter-row",span:6},i.a.createElement("div",{style:Object(h.a)(Object(h.a)({},S),{},{backgroundColor:e.isAvailable?"#98FB98":"#87CEFA",color:"black",width:300,height:100,margin:10,display:"flex",justifyContent:"center",alignItems:"center",fontSize:20})}," ",e.machineType+" "+e.sn," ")):null})))}(e,a))}))))}}]),a}(n.Component),j=a(502),k=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.data,t=0;return e.map((function(e){return e.isAvailable&&(t+=1),null})),i.a.createElement(i.a.Fragment,null,i.a.createElement(j.a,{title:"Statistics"},i.a.createElement(j.a.Item,{label:"Washer & Dryer"},e.length),i.a.createElement(j.a.Item,{label:"Available Machines"},t)),",")}}]),a}(n.Component),O=a(97),T=a(496),D=a(494),x=a(490),R=a(48),C=a(492),L=a(491),A=O.a.Option,w=function(e){var t=e.editing,a=e.dataIndex,n=e.title,r=e.inputType,c=(e.record,e.index,e.children),o=Object(g.a)(e,["editing","dataIndex","title","inputType","record","index","children"]),l="number"===r?i.a.createElement(T.a,null):i.a.createElement(D.a,null);return i.a.createElement("td",o,t?i.a.createElement(L.a.Item,{name:a,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(n,"!")}]},l):c)};function N(e){console.log("selected ".concat(e))}var K=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).formRef=i.a.createRef(),n.edit=function(e){var t=n.state.machine;n.formRef.current.setFieldsValue(Object(h.a)({sn:"",isAvailable:"",machineType:t,locationID:"",userID:"",userReservedID:"",scanString:""},e)),n.setState({editingKey:e._id})},n.isEditing=function(e){return e._id===n.state.editingKey},n.cancel=function(){n.setState({editingKey:""})},n.save=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,i,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.formRef.current.validateFields();case 3:a=e.sent,i=Object(p.a)(n.state.dataSource),(r=i.findIndex((function(e){return e._id===t})))>-1?(c=i[r],i.splice(r,1,Object(h.a)(Object(h.a)({},c),a)),"VirtualID"===t?n.handleAdd(i[r]):n.handleSave(i[r]),n.setState({dataSource:i,editingKey:""})):n.setState({dataSource:i,editingKey:""}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),n.handleSave=function(e){n.state.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/machines/".concat(e._id),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify({sn:e.sn,isAvailable:e.isAvailable,machineType:e.machineType,locationID:e.locationID,userID:e.userID,userReservedID:e.userReservedID,scanString:e.scanString})}).then((function(e){return e.json()})).then((function(e){return e.isSuccess})).catch((function(e){return console.log(e)}))},n.handleDelete=function(e){var t=n.state,a=t.count,i=t.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/machines/".concat(e),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(){return n.setState({dataSource:i.filter((function(t){return t._id!==e})),count:a-1})})).catch((function(e){return console.log(e)}))},n.onAdd=function(){var e=n.state,t=e.count,a=e.dataSource,i={sn:"",isAvailable:"",machineType:"",locationID:"",userID:"",userReservedID:"",scanString:"",_id:"VirtualID"};n.setState({dataSource:[].concat(Object(p.a)(a),[i]),count:t+1}),n.edit(i)},n.handleAdd=function(e){fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/machines",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({sn:e.sn,isAvailable:e.isAvailable,machineType:e.machineType,locationID:e.locationID,userID:e.userID,userReservedID:e.userReservedID,scanString:e.scanString})}).then((function(e){return e.json()})).then((function(t){return t.isSuccess&&(e._id=t.id),t.isSuccess})).catch((function(e){return console.log(e)}))},n.state={dataSource:n.props.data,count:n.props.data.length,editingKey:"",machine:""};i.a.createRef();return n.columns=[{title:"SN",dataIndex:"sn",key:"sn",editable:!0},{title:"IsAvailable",dataIndex:"isAvailable",key:"isAvailable",editable:!0},{title:"MachineType",dataIndex:"machineType",key:"machineType",editable:!0,render:function(e,t){var a=n.isEditing(t);n.state.machine;return a?i.a.createElement(O.a,{defaultValue:t.machineType,style:{width:120},onChange:function(e,t){t.machineType=e,n.setState({machine:e})}},i.a.createElement(A,{value:"washer"},"washer"),i.a.createElement(A,{value:"lucy"},"dryer")):i.a.createElement(O.a,{defaultValue:t.machineType,style:{width:120},onChange:N})}},{title:"LocationID",dataIndex:"locationID",key:"locationID",editable:!0},{title:"UserID",dataIndex:"userID",key:"userID",editable:!0},{title:"UserReservedID",dataIndex:"userReservedID",key:"userReservedID",editable:!0},{title:"ScanString",dataIndex:"scanString",key:"scanString",editable:!0},{title:"",key:"delete",render:function(e,t){return n.state.dataSource.length>=1?i.a.createElement(x.a,{title:"Sure to delete?",onConfirm:function(){return n.handleDelete(t._id)}},i.a.createElement("a",null,"Delete")):null}},{title:"",key:"edit",render:function(e,t){return n.isEditing(t)?i.a.createElement("span",null,i.a.createElement("a",{onClick:function(){return n.save(t._id)},style:{marginRight:8}},"Save"),i.a.createElement(x.a,{title:"Sure to cancel?",onConfirm:n.cancel},i.a.createElement("a",null,"Cancel"))):i.a.createElement("a",{disabled:""!==n.state.editingKey,onClick:function(){return n.edit(t)}},"Edit")}}],n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.data,a=this.state.dataSource,n=this.columns.map((function(t){return t.editable?Object(h.a)(Object(h.a)({},t),{},{onCell:function(a){return{record:a,inputType:"text",dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(a)}}}):t}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,i.a.createElement(R.a,{disabled:""!==this.state.editingKey,onClick:this.onAdd,type:"primary",style:{marginTop:16,marginBottom:16}},"Add a New Location"),i.a.createElement(L.a,{ref:this.formRef,component:!1},i.a.createElement(C.a,{components:{body:{cell:w}},bordered:!0,rowKey:"_id",dataSource:a,columns:n,rowClassName:"editable-row",pagination:{onChange:this.cancel}}))),i.a.createElement(k,{data:t}),i.a.createElement(I,{data:t}))}}]),a}(n.Component),_=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.user,t=[{title:"RegisterDate",dataIndex:"registerDate",key:"date",render:function(e){return i.a.createElement("a",null,e)}},{title:"FirstName",dataIndex:"firstName",key:"firstName"},{title:"LastName",dataIndex:"lastName",key:"lastName"},{title:"Email",dataIndex:"email",key:"email"},{title:"LocationID",dataIndex:"locationID",key:"locationID"}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(C.a,{columns:t,dataSource:e}))}}]),a}(n.Component),F=function(e){var t=e.editing,a=e.dataIndex,n=e.title,r=e.inputType,c=(e.record,e.index,e.children),o=Object(g.a)(e,["editing","dataIndex","title","inputType","record","index","children"]),l="number"===r?i.a.createElement(T.a,null):i.a.createElement(D.a,null);return i.a.createElement("td",o,t?i.a.createElement(L.a.Item,{name:a,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(n,"!")}]},l):c)},P=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).formRef=i.a.createRef(),n.edit=function(e){n.formRef.current.setFieldsValue(Object(h.a)({name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:""},e)),n.setState({editingKey:e._id})},n.isEditing=function(e){return e._id===n.state.editingKey},n.cancel=function(){n.setState({editingKey:""})},n.save=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,i,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.formRef.current.validateFields();case 3:a=e.sent,i=Object(p.a)(n.state.dataSource),(r=i.findIndex((function(e){return e._id===t})))>-1?(c=i[r],i.splice(r,1,Object(h.a)(Object(h.a)({},c),a)),"VirtualID"===t?n.handleAdd(i[r]):n.handleSave(i[r]),n.setState({dataSource:i,editingKey:""})):n.setState({dataSource:i,editingKey:""}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),n.handleSave=function(e){n.state.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations/".concat(e._id),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(e){return e.isSuccess})).catch((function(e){return console.log(e)}))},n.handleDelete=function(e){var t=n.state,a=t.count,i=t.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations/".concat(e),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(){return n.setState({dataSource:i.filter((function(t){return t._id!==e})),count:a-1})})).catch((function(e){return console.log(e)}))},n.onAdd=function(){var e=n.state,t=e.count,a=e.dataSource,i={name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:"",_id:"VirtualID"};n.setState({dataSource:[].concat(Object(p.a)(a),[i]),count:t+1}),n.edit(i)},n.handleAdd=function(e){fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(t){return t.isSuccess&&(e._id=t.id),t.isSuccess})).catch((function(e){return console.log(e)}))},n.state={dataSource:n.props.location,count:n.props.location.length,editingKey:""};i.a.createRef();return n.columns=[{title:"Name",dataIndex:"name",key:"name",editable:!0},{title:"Email",dataIndex:"email",key:"email",editable:!0},{title:"DefaultRunningTime",dataIndex:"defaultRunningTime",key:"defaultRunningTime",editable:!0},{title:"DefaultReservationExpireTime",dataIndex:"defaultReservationExpireTime",key:"defaultReservationExpireTime",editable:!0},{title:"DefaultPickupTime",dataIndex:"defaultPickupTime",key:"defaultPickupTime",editable:!0},{title:"",key:"delete",render:function(e,t){return n.state.dataSource.length>=1?i.a.createElement(x.a,{title:"Sure to delete?",onConfirm:function(){return n.handleDelete(t._id)}},i.a.createElement("a",null,"Delete")):null}},{title:"",key:"edit",render:function(e,t){return n.isEditing(t)?i.a.createElement("span",null,i.a.createElement("a",{onClick:function(){return n.save(t._id)},style:{marginRight:8}},"Save"),i.a.createElement(x.a,{title:"Sure to cancel?",onConfirm:n.cancel},i.a.createElement("a",null,"Cancel"))):i.a.createElement("a",{disabled:""!==n.state.editingKey,onClick:function(){return n.edit(t)}},"Edit")}}],n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.dataSource,a=this.columns.map((function(t){return t.editable?Object(h.a)(Object(h.a)({},t),{},{onCell:function(a){return{record:a,inputType:"name"===t.dataIndex||"email"===t.dataIndex?"text":"number",dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(a)}}}):t}));return i.a.createElement("div",null,i.a.createElement(R.a,{disabled:""!==this.state.editingKey,onClick:this.onAdd,type:"primary",style:{marginTop:16,marginBottom:16}},"Add a New Location"),i.a.createElement(L.a,{ref:this.formRef,component:!1},i.a.createElement(C.a,{components:{body:{cell:F}},bordered:!0,rowKey:"_id",dataSource:t,columns:a,rowClassName:"editable-row",pagination:{onChange:this.cancel}})))}}]),a}(n.Component),M="http://lmapp.us-east-2.elasticbeanstalk.com/api",U=a(6),V=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("header",{className:"App-header"},i.a.createElement("span",{className:"App-title"},"Sparking Laundry Management"),this.props.isLoggedIn?i.a.createElement("a",{className:"logout",onClick:this.props.handleLogout},i.a.createElement(U.a,{type:"logout"})," ","Logout"):null)}}]),a}(n.Component),B=a(498),J=a(500),q=a(501),Y=a(497),z=a(493),W=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).handleSubmit=function(t){t.preventDefault(),e.props.form.validateFields((function(t,a){t||(console.log("Received values of form: ",a),fetch("".concat(M,"/admin/login"),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:a.username,password:a.password})}).then((function(e){if(e.ok)return e.json();throw new Error("ERROR")})).then((function(t){e.props.handleLoginSucceed(t.token),Y.a.success("Login succeed!")})).catch((function(e){console.log(e),Y.a.error("Login failed.")})))}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return i.a.createElement(z.a,{onSubmit:this.handleSubmit,className:"login-form"},i.a.createElement("p",{className:"login-title"},"Admin Login"),i.a.createElement(z.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(i.a.createElement(D.a,{prefix:i.a.createElement(U.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),i.a.createElement(z.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(i.a.createElement(D.a,{prefix:i.a.createElement(U.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),i.a.createElement(z.a.Item,null,i.a.createElement(R.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))}}]),a}(n.Component),G=z.a.create({name:"normal_login"})(W),H=a(173),Q=a(495),X=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={current:"Machine"},e.handleClick=function(t){console.log("click ",t),e.setState({current:t.key})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.user,n=e.location,r=this.state.current;return i.a.createElement("div",null,i.a.createElement(H.a,{onClick:this.handleClick,selectedKeys:[r],mode:"horizontal"},i.a.createElement(H.a.Item,{key:"Machine",icon:i.a.createElement(Q.a,null)}," Machine Status"),i.a.createElement(H.a.Item,{key:"User",icon:i.a.createElement(Q.a,null)}," User Status"),i.a.createElement(H.a.Item,{key:"Location",icon:i.a.createElement(Q.a,null)}," Location ")),function(e){switch(e){case"Machine":return i.a.createElement(K,{data:t});case"User":return i.a.createElement(_,{user:a});case"Location":return i.a.createElement(P,{location:n});default:return i.a.createElement(K,{data:t})}}(r))}}]),a}(n.Component),Z=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).getLogin=function(){return e.props.isLoggedIn?i.a.createElement(B.a,{to:"/home"}):i.a.createElement(G,{handleLoginSucceed:e.props.handleLoginSucceed})},e.getMachine=function(){return e.props.isLoggedIn?i.a.createElement(X,{data:e.props.data,user:e.props.user,location:e.props.location}):i.a.createElement(B.a,{to:"/login"})},e}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"main"},i.a.createElement(J.a,null,i.a.createElement(q.a,{path:"/login",render:this.getLogin}),i.a.createElement(q.a,{path:"/home",render:this.getMachine}),i.a.createElement(q.a,{render:this.getLogin})),i.a.createElement("p",{className:"footnote"},"Sparkling Laundry Management, Mailing Address: admin@foxmail.com, LMA 2020 Project"))}}]),a}(n.Component),$=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={data:[],user:[],location:[],isLoggedIn:Boolean(localStorage.getItem("TOKEN_KEY"))},e.handleLoginSucceed=function(t){console.log("token --- ",t),localStorage.setItem("TOKEN_KEY",t),e.setState({isLoggedIn:!0})},e.handleLogout=function(){localStorage.removeItem("TOKEN_KEY"),e.setState({isLoggedIn:!1})},e.getMachineFromDb=function(){fetch("/api/machines").then((function(e){return e.json()})).then((function(t){return e.setState({data:t.machines})}))},e.getUserFromDb=function(){fetch("/api/users").then((function(e){return e.json()})).then((function(t){return e.setState({user:t.users})}))},e.getLocationFromDb=function(){fetch("/api/locations").then((function(e){return e.json()})).then((function(t){return e.setState({location:t.locations})}))},e.putDataToDB=function(e){},e.deleteFromDB=function(e){},e.updateDB=function(e,t){},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getMachineFromDb(),this.getUserFromDb(),this.getLocationFromDb()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(V,{handleLogout:this.handleLogout,isLoggedIn:this.state.isLoggedIn}),i.a.createElement(Z,{handleLoginSucceed:this.handleLoginSucceed,isLoggedIn:this.state.isLoggedIn,data:this.state.data,user:this.state.user,location:this.state.location}))}}]),a}(n.Component),ee=a(499);c.a.render(i.a.createElement(ee.a,null,i.a.createElement($,null)),document.getElementById("root"))}},[[251,1,2]]]);
//# sourceMappingURL=main.da692c24.chunk.js.map