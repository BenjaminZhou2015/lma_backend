(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{176:function(e,t,n){},251:function(e,t,n){e.exports=n(485)},485:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(4),c=n.n(r),o=(n(176),n(26)),l=n(27),u=n(29),s=n(28),d=n(85),m=n.n(d),p=n(86),f=n(120),h=n(33),g=n(132),y=n(215),E=n(487),b=n(488),v=n(489),S=(n(101),{background:"#0092ff",padding:"8px 0"}),I=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=(e.location,[]),a=[];t.map((function(e){return function(e){var t,a=Object(y.a)(n);try{for(a.s();!(t=a.n()).done;){if(e===t.value)return!0}}catch(i){a.e(i)}finally{a.f()}return!1}(e.locationID)||(n.push(e.locationID),a.push(n.length-1)),null}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,a.map((function(e){return i.a.createElement("div",null,i.a.createElement(v.a,{orientation:"middle",style:{color:"#333",fontWeight:"normal",fontSize:30,height:50,justifyContent:"center",alignItems:"center"}},"location:"+e),function(e,t){return i.a.createElement(E.a,{gutter:[16,24]},e.length<=0?"NO DB ENTRIES YET":e.sort((function(e,t){return e.machineType===t.machineType?e.sn<t.sn?-1:1:"washer"===e.machineType?-1:1})).map((function(e){return e.locationID==n[t]?i.a.createElement(b.a,{className:"gutter-row",span:6},i.a.createElement("div",{style:Object(h.a)(Object(h.a)({},S),{},{backgroundColor:e.isAvailable?"#98FB98":"#87CEFA",color:"black",width:300,height:100,margin:10,display:"flex",justifyContent:"center",alignItems:"center",fontSize:20})}," ",e.machineType+" "+e.sn," ")):null})))}(t,e))}))))}}]),n}(a.Component),j=n(502),O=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.data,t=0;return e.map((function(e){return e.isAvailable&&(t+=1),null})),i.a.createElement(i.a.Fragment,null,i.a.createElement(j.a,{title:"Statistics"},i.a.createElement(j.a.Item,{label:"Washer & Dryer"},e.length),i.a.createElement(j.a.Item,{label:"Available Machines"},t)),",")}}]),n}(a.Component),k=n(97),T=n(496),D=n(494),x=n(490),R=n(48),C=n(492),L=n(491),A=k.a.Option,w=function(e){var t=e.editing,n=e.dataIndex,a=e.title,r=e.inputType,c=(e.record,e.index,e.children),o=Object(g.a)(e,["editing","dataIndex","title","inputType","record","index","children"]),l="number"===r?i.a.createElement(T.a,null):i.a.createElement(D.a,null);return i.a.createElement("td",o,t?i.a.createElement(L.a.Item,{name:n,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(a,"!")}]},l):c)};function N(e){console.log("selected ".concat(e))}var K=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).formRef=i.a.createRef(),a.edit=function(e){var t=a.state.machine;a.formRef.current.setFieldsValue(Object(h.a)({sn:"",isAvailable:"",machineType:t,locationID:"",userID:"",userReservedID:"",scanString:""},e)),a.setState({editingKey:e._id})},a.isEditing=function(e){return e._id===a.state.editingKey},a.cancel=function(){a.setState({editingKey:""})},a.save=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,i,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.formRef.current.validateFields();case 3:n=e.sent,i=Object(p.a)(a.state.dataSource),(r=i.findIndex((function(e){return e._id===t})))>-1?(c=i[r],i.splice(r,1,Object(h.a)(Object(h.a)({},c),n)),"VirtualID"===t?a.handleAdd(i[r]):a.handleSave(i[r]),a.setState({dataSource:i,editingKey:""})):a.setState({dataSource:i,editingKey:""}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),a.handleSave=function(e){a.state.dataSource;fetch("/api/machines/".concat(e._id),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify({sn:e.sn,isAvailable:e.isAvailable,machineType:e.machineType,locationID:e.locationID,userID:e.userID,userReservedID:e.userReservedID,scanString:e.scanString})}).then((function(e){return e.json()})).then((function(e){return e.isSuccess})).catch((function(e){return console.log(e)}))},a.handleDelete=function(e){var t=a.state,n=t.count,i=t.dataSource;fetch("/api/machines/".concat(e),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(){return a.setState({dataSource:i.filter((function(t){return t._id!==e})),count:n-1})})).catch((function(e){return console.log(e)}))},a.onAdd=function(){var e=a.state,t=e.count,n=e.dataSource,i={sn:"",isAvailable:"",machineType:"",locationID:"",userID:"",userReservedID:"",scanString:"",_id:"VirtualID"};a.setState({dataSource:[].concat(Object(p.a)(n),[i]),count:t+1}),a.edit(i)},a.handleAdd=function(e){fetch("/api/machines",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({sn:e.sn,isAvailable:e.isAvailable,machineType:e.machineType,locationID:e.locationID,userID:e.userID,userReservedID:e.userReservedID,scanString:e.scanString})}).then((function(e){return e.json()})).then((function(t){return t.isSuccess&&(e._id=t.id),t.isSuccess})).catch((function(e){return console.log(e)}))},a.state={dataSource:a.props.data,count:a.props.data.length,editingKey:"",machine:""};i.a.createRef();return a.columns=[{title:"SN",dataIndex:"sn",key:"sn",editable:!0},{title:"IsAvailable",dataIndex:"isAvailable",key:"isAvailable",editable:!0},{title:"MachineType",dataIndex:"machineType",key:"machineType",editable:!0,render:function(e,t){var n=a.isEditing(t);a.state.machine;return n?i.a.createElement(k.a,{defaultValue:t.machineType,style:{width:120},onChange:function(e,t){t.machineType=e}},i.a.createElement(A,{value:"washer"},"washer"),i.a.createElement(A,{value:"dryer"},"dryer")):i.a.createElement(k.a,{defaultValue:t.machineType,style:{width:120},onChange:N})}},{title:"LocationID",dataIndex:"locationID",key:"locationID",editable:!0},{title:"UserID",dataIndex:"userID",key:"userID",editable:!0},{title:"UserReservedID",dataIndex:"userReservedID",key:"userReservedID",editable:!0},{title:"ScanString",dataIndex:"scanString",key:"scanString",editable:!0},{title:"",key:"delete",render:function(e,t){return a.state.dataSource.length>=1?i.a.createElement(x.a,{title:"Sure to delete?",onConfirm:function(){return a.handleDelete(t._id)}},i.a.createElement("a",null,"Delete")):null}},{title:"",key:"edit",render:function(e,t){return a.isEditing(t)?i.a.createElement("span",null,i.a.createElement("a",{onClick:function(){return a.save(t._id)},style:{marginRight:8}},"Save"),i.a.createElement(x.a,{title:"Sure to cancel?",onConfirm:a.cancel},i.a.createElement("a",null,"Cancel"))):i.a.createElement("a",{disabled:""!==a.state.editingKey,onClick:function(){return a.edit(t)}},"Edit")}}],a}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.location,r=this.state.dataSource,c=this.columns.map((function(t){return t.editable?Object(h.a)(Object(h.a)({},t),{},{onCell:function(n){return{record:n,inputType:"text",dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(n)}}}):t}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,i.a.createElement(R.a,{disabled:""!==this.state.editingKey,onClick:this.onAdd,type:"primary",style:{marginTop:16,marginBottom:16}},"Add a New Location"),i.a.createElement(L.a,{ref:this.formRef,component:!1},i.a.createElement(C.a,{components:{body:{cell:w}},bordered:!0,rowKey:"_id",dataSource:r,columns:c,rowClassName:"editable-row",pagination:{onChange:this.cancel}}))),i.a.createElement(O,{data:n}),i.a.createElement(I,{data:n,location:a}))}}]),n}(a.Component),_=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.user,t=[{title:"RegisterDate",dataIndex:"registerDate",key:"date",render:function(e){return i.a.createElement("a",null,e)}},{title:"FirstName",dataIndex:"firstName",key:"firstName"},{title:"LastName",dataIndex:"lastName",key:"lastName"},{title:"Email",dataIndex:"email",key:"email"},{title:"LocationID",dataIndex:"locationID",key:"locationID"}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(C.a,{columns:t,dataSource:e}))}}]),n}(a.Component),F=function(e){var t=e.editing,n=e.dataIndex,a=e.title,r=e.inputType,c=(e.record,e.index,e.children),o=Object(g.a)(e,["editing","dataIndex","title","inputType","record","index","children"]),l="number"===r?i.a.createElement(T.a,null):i.a.createElement(D.a,null);return i.a.createElement("td",o,t?i.a.createElement(L.a.Item,{name:n,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(a,"!")}]},l):c)},P=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).formRef=i.a.createRef(),a.edit=function(e){a.formRef.current.setFieldsValue(Object(h.a)({name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:""},e)),a.setState({editingKey:e._id})},a.isEditing=function(e){return e._id===a.state.editingKey},a.cancel=function(){var e=a.state.dataSource;a.setState({dataSource:e.filter((function(e){return"VirtualID"!==e._id})),editingKey:""})},a.save=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,i,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.formRef.current.validateFields();case 3:n=e.sent,i=Object(p.a)(a.state.dataSource),(r=i.findIndex((function(e){return e._id===t})))>-1?(c=i[r],i.splice(r,1,Object(h.a)(Object(h.a)({},c),n)),"VirtualID"===t?a.handleAdd(i[r]):a.handleSave(i[r]),a.setState({dataSource:i,editingKey:""})):a.setState({dataSource:i,editingKey:""}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),a.handleSave=function(e){a.state.dataSource;fetch("/api/locations/".concat(e._id),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(e){return e.isSuccess})).catch((function(e){return console.log(e)}))},a.handleDelete=function(e){var t=a.state,n=t.count,i=t.dataSource;fetch("/api/locations/".concat(e),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(){return a.setState({dataSource:i.filter((function(t){return t._id!==e})),count:n-1})})).catch((function(e){return console.log(e)}))},a.onAdd=function(){var e=a.state,t=e.count,n=e.dataSource,i={name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:"",_id:"VirtualID"};a.setState({dataSource:[].concat(Object(p.a)(n),[i]),count:t+1}),a.edit(i)},a.handleAdd=function(e){fetch("/api/locations",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(t){return t.isSuccess&&(e._id=t.id),t.isSuccess})).catch((function(e){return console.log(e)}))},a.state={dataSource:a.props.location,count:a.props.location.length,editingKey:""};i.a.createRef();return a.columns=[{title:"Name",dataIndex:"name",key:"name",editable:!0},{title:"Email",dataIndex:"email",key:"email",editable:!0},{title:"DefaultRunningTime",dataIndex:"defaultRunningTime",key:"defaultRunningTime",editable:!0},{title:"DefaultReservationExpireTime",dataIndex:"defaultReservationExpireTime",key:"defaultReservationExpireTime",editable:!0},{title:"DefaultPickupTime",dataIndex:"defaultPickupTime",key:"defaultPickupTime",editable:!0},{title:"",key:"delete",render:function(e,t){return a.state.dataSource.length>=1?i.a.createElement(x.a,{title:"Sure to delete?",onConfirm:function(){return a.handleDelete(t._id)}},i.a.createElement("a",{disabled:"VirtualID"===a.state.editingKey},"Delete")):null}},{title:"",key:"edit",render:function(e,t){return a.isEditing(t)?i.a.createElement("span",null,i.a.createElement("a",{onClick:function(){return a.save(t._id)},style:{marginRight:8}},"Save"),i.a.createElement("a",{onClick:function(){return a.cancel()}},"Cancel")):i.a.createElement("a",{disabled:""!==a.state.editingKey,onClick:function(){return a.edit(t)}},"Edit")}}],a}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.state.dataSource,n=this.columns.map((function(t){return t.editable?Object(h.a)(Object(h.a)({},t),{},{onCell:function(n){return{record:n,inputType:"name"===t.dataIndex||"email"===t.dataIndex?"text":"number",dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(n)}}}):t}));return i.a.createElement("div",null,i.a.createElement(R.a,{disabled:""!==this.state.editingKey,onClick:this.onAdd,type:"primary",style:{marginTop:16,marginBottom:16}},"Add a New Location"),i.a.createElement(L.a,{ref:this.formRef,component:!1},i.a.createElement(C.a,{components:{body:{cell:F}},bordered:!0,rowKey:"_id",dataSource:t,columns:n,rowClassName:"editable-row",pagination:{onChange:this.cancel}})))}}]),n}(a.Component),M="http://lmapp.us-east-2.elasticbeanstalk.com/api",V=n(6),U=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("header",{className:"App-header"},i.a.createElement("span",{className:"App-title"},"Sparkling Laundry Management"),this.props.isLoggedIn?i.a.createElement("a",{className:"logout",onClick:this.props.handleLogout},i.a.createElement(V.a,{type:"logout"})," ","Logout"):null)}}]),n}(a.Component),B=n(498),J=n(500),q=n(501),Y=n(497),z=n(493),W=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).handleSubmit=function(t){t.preventDefault(),e.props.form.validateFields((function(t,n){t||(console.log("Received values of form: ",n),fetch("".concat(M,"/admin/login"),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:n.username,password:n.password})}).then((function(e){if(e.ok)return e.json();throw new Error("ERROR")})).then((function(t){e.props.handleLoginSucceed(t.token),Y.a.success("Login succeed!")})).catch((function(e){console.log(e),Y.a.error("Login failed.")})))}))},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return i.a.createElement(z.a,{onSubmit:this.handleSubmit,className:"login-form"},i.a.createElement("p",{className:"login-title"},"Admin Login"),i.a.createElement(z.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(i.a.createElement(D.a,{prefix:i.a.createElement(V.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),i.a.createElement(z.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(i.a.createElement(D.a,{prefix:i.a.createElement(V.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),i.a.createElement(z.a.Item,null,i.a.createElement(R.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))}}]),n}(a.Component),G=z.a.create({name:"normal_login"})(W),H=n(173),Q=n(495),X=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={current:"Machine"},e.handleClick=function(t){console.log("click ",t),e.setState({current:t.key})},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.user,a=e.location,r=this.state.current;return i.a.createElement("div",null,i.a.createElement(H.a,{onClick:this.handleClick,selectedKeys:[r],mode:"horizontal"},i.a.createElement(H.a.Item,{key:"Machine",icon:i.a.createElement(Q.a,null)}," Machine Status"),i.a.createElement(H.a.Item,{key:"User",icon:i.a.createElement(Q.a,null)}," User Status"),i.a.createElement(H.a.Item,{key:"Location",icon:i.a.createElement(Q.a,null)}," Location ")),function(e){switch(e){case"Machine":return i.a.createElement(K,{data:t,location:a});case"User":return i.a.createElement(_,{user:n});case"Location":return i.a.createElement(P,{location:a});default:return i.a.createElement(K,{data:t})}}(r))}}]),n}(a.Component),Z=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).getLogin=function(){return e.props.isLoggedIn?i.a.createElement(B.a,{to:"/home"}):i.a.createElement(G,{handleLoginSucceed:e.props.handleLoginSucceed})},e.getMachine=function(){return e.props.isLoggedIn?i.a.createElement(X,{data:e.props.data,user:e.props.user,location:e.props.location}):i.a.createElement(B.a,{to:"/login"})},e}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"main"},i.a.createElement(J.a,null,i.a.createElement(q.a,{path:"/login",render:this.getLogin}),i.a.createElement(q.a,{path:"/home",render:this.getMachine}),i.a.createElement(q.a,{render:this.getLogin})),i.a.createElement("p",{className:"footnote"},"Sparkling Laundry Management, Mailing Address: admin@foxmail.com, LMA 2020 Project"))}}]),n}(a.Component),$=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={data:[],user:[],location:[],isLoggedIn:Boolean(localStorage.getItem("TOKEN_KEY"))},e.handleLoginSucceed=function(t){console.log("token --- ",t),localStorage.setItem("TOKEN_KEY",t),e.setState({isLoggedIn:!0})},e.handleLogout=function(){localStorage.removeItem("TOKEN_KEY"),e.setState({isLoggedIn:!1})},e.getMachineFromDb=function(){fetch("/api/machines").then((function(e){return e.json()})).then((function(t){return e.setState({data:t.machines})}))},e.getUserFromDb=function(){fetch("/api/users").then((function(e){return e.json()})).then((function(t){return e.setState({user:t.users})}))},e.getLocationFromDb=function(){fetch("/api/locations").then((function(e){return e.json()})).then((function(t){return e.setState({location:t.locations})}))},e.putDataToDB=function(e){},e.deleteFromDB=function(e){},e.updateDB=function(e,t){},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getMachineFromDb(),this.getUserFromDb(),this.getLocationFromDb()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(U,{handleLogout:this.handleLogout,isLoggedIn:this.state.isLoggedIn}),i.a.createElement(Z,{handleLoginSucceed:this.handleLoginSucceed,isLoggedIn:this.state.isLoggedIn,data:this.state.data,user:this.state.user,location:this.state.location}))}}]),n}(a.Component),ee=n(499);c.a.render(i.a.createElement(ee.a,null,i.a.createElement($,null)),document.getElementById("root"))}},[[251,1,2]]]);
//# sourceMappingURL=main.cfe7bef9.chunk.js.map