(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{172:function(e,t,a){},246:function(e,t,a){e.exports=a(480)},480:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(4),c=a.n(i),o=(a(172),a(26)),l=a(27),u=a(29),s=a(28),d=a(51),m=a(483),p=a(484),f=a(485),h=(a(98),{background:"#0092ff",padding:"8px 0"}),g=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.data;return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{orientation:"middle",style:{color:"#333",fontWeight:"normal",fontSize:30}},"live status"),r.a.createElement(p.a,{gutter:[16,24]},e.length<=0?"NO DB ENTRIES YET":e.sort((function(e){return"washer"===e.machineType?-1:1})).map((function(e){return r.a.createElement(f.a,{className:"gutter-row",span:6},r.a.createElement("div",{style:Object(d.a)(Object(d.a)({},h),{},{backgroundColor:e.isAvailable?"#98FB98":"#87CEFA",color:"black",width:300,height:100,margin:10,display:"flex",justifyContent:"center",alignItems:"center",fontSize:20})}," ",e.machineType+" "+e.sn," "))}))))}}]),a}(n.Component),E=a(498),b=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.data,t=0;return e.map((function(e){return e.isAvailable&&(t+=1),null})),r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{title:"Statistics"},r.a.createElement(E.a.Item,{label:"Washer & Dryer"},e.length),r.a.createElement(E.a.Item,{label:"Available Machines"},t)),",")}}]),a}(n.Component),y=a(488),v=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.user,t=[{title:"RegisterDate",dataIndex:"registerDate",key:"date",render:function(e){return r.a.createElement("a",null,e)}},{title:"FirstName",dataIndex:"firstName",key:"firstName"},{title:"LastName",dataIndex:"lastName",key:"lastName"},{title:"Email",dataIndex:"email",key:"email"},{title:"LocationID",dataIndex:"locationID",key:"locationID"}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{columns:t,dataSource:e}))}}]),a}(n.Component),j=a(165),k=a.n(j),O=a(168),S=a(216),I=a(241),T=a(492),L=a(490),x=a(486),R=a(47),C=a(487),D=function(e){var t=e.editing,a=e.dataIndex,n=e.title,i=e.inputType,c=(e.record,e.index,e.children),o=Object(I.a)(e,["editing","dataIndex","title","inputType","record","index","children"]),l="number"===i?r.a.createElement(T.a,null):r.a.createElement(L.a,null);return r.a.createElement("td",o,t?r.a.createElement(C.a.Item,{name:a,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(n,"!")}]},l):c)},N=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).formRef=r.a.createRef(),n.edit=function(e){n.formRef.current.setFieldsValue(Object(d.a)({name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:""},e)),n.setState({editingKey:e._id})},n.isEditing=function(e){return e._id===n.state.editingKey},n.cancel=function(){n.setState({editingKey:""})},n.save=function(){var e=Object(S.a)(k.a.mark((function e(t){var a,r,i,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.formRef.current.validateFields();case 3:a=e.sent,r=Object(O.a)(n.state.dataSource),(i=r.findIndex((function(e){return e._id===t})))>-1?(c=r[i],r.splice(i,1,Object(d.a)(Object(d.a)({},c),a)),"VirtualID"===t?n.handleAdd(r[i]):n.handleSave(r[i]),n.setState({dataSource:r,editingKey:""})):n.setState({dataSource:r,editingKey:""}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),n.handleSave=function(e){n.state.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations/".concat(e._id),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(e){return e.isSuccess})).catch((function(e){return console.log(e)}))},n.handleDelete=function(e){var t=n.state,a=t.count,r=t.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations/".concat(e),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(){return n.setState({dataSource:r.filter((function(t){return t._id!==e})),count:a-1})})).catch((function(e){return console.log(e)}))},n.onAdd=function(){var e=n.state,t=e.count,a=e.dataSource,r={name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:"",_id:"VirtualID"};n.setState({dataSource:[].concat(Object(O.a)(a),[r]),count:t+1}),n.edit(r)},n.handleAdd=function(e){fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(t){return t.isSuccess&&(e._id=t.id),t.isSuccess})).catch((function(e){return console.log(e)}))},n.state={dataSource:n.props.location,count:n.props.location.length,editingKey:""};r.a.createRef();return n.columns=[{title:"Name",dataIndex:"name",key:"name",editable:!0},{title:"Email",dataIndex:"email",key:"email",editable:!0},{title:"DefaultRunningTime",dataIndex:"defaultRunningTime",key:"defaultRunningTime",editable:!0},{title:"DefaultReservationExpireTime",dataIndex:"defaultReservationExpireTime",key:"defaultReservationExpireTime",editable:!0},{title:"DefaultPickupTime",dataIndex:"defaultPickupTime",key:"defaultPickupTime",editable:!0},{title:"",key:"delete",render:function(e,t){return n.state.dataSource.length>=1?r.a.createElement(x.a,{title:"Sure to delete?",onConfirm:function(){return n.handleDelete(t._id)}},r.a.createElement("a",null,"Delete")):null}},{title:"",key:"edit",render:function(e,t){return n.isEditing(t)?r.a.createElement("span",null,r.a.createElement("a",{onClick:function(){return n.save(t._id)},style:{marginRight:8}},"Save"),r.a.createElement(x.a,{title:"Sure to cancel?",onConfirm:n.cancel},r.a.createElement("a",null,"Cancel"))):r.a.createElement("a",{disabled:""!==n.state.editingKey,onClick:function(){return n.edit(t)}},"Edit")}}],n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.dataSource,a=this.columns.map((function(t){return t.editable?Object(d.a)(Object(d.a)({},t),{},{onCell:function(a){return{record:a,inputType:"name"===t.dataIndex||"email"===t.dataIndex?"text":"number",dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(a)}}}):t}));return r.a.createElement("div",null,r.a.createElement(R.a,{disabled:""!==this.state.editingKey,onClick:this.onAdd,type:"primary",style:{marginTop:16,marginBottom:16}},"Add a New Location"),r.a.createElement(C.a,{ref:this.formRef,component:!1},r.a.createElement(y.a,{components:{body:{cell:D}},bordered:!0,rowKey:"_id",dataSource:t,columns:a,rowClassName:"editable-row",pagination:{onChange:this.cancel}})))}}]),a}(n.Component),w=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.data;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,{data:e}),r.a.createElement(g,{data:e}))}}]),a}(n.Component),A="http://lmapp.us-east-2.elasticbeanstalk.com/api",F=a(6),P=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("header",{className:"App-header"},r.a.createElement("span",{className:"App-title"},"Sparking Laundry Management"),this.props.isLoggedIn?r.a.createElement("a",{className:"logout",onClick:this.props.handleLogout},r.a.createElement(F.a,{type:"logout"})," ","Logout"):null)}}]),a}(n.Component),K=a(494),M=a(496),_=a(497),B=a(493),U=a(489),J=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleSubmit=function(t){t.preventDefault(),e.props.form.validateFields((function(t,a){t||(console.log("Received values of form: ",a),fetch("".concat(A,"/admin/login"),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:a.username,password:a.password})}).then((function(e){if(e.ok)return e.json();throw new Error("ERROR")})).then((function(t){e.props.handleLoginSucceed(t.token),B.a.success("Login succeed!")})).catch((function(e){console.log(e),B.a.error("Login failed.")})))}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(U.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement("p",{className:"login-title"},"Admin Login"),r.a.createElement(U.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(r.a.createElement(L.a,{prefix:r.a.createElement(F.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),r.a.createElement(U.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(L.a,{prefix:r.a.createElement(F.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),r.a.createElement(U.a.Item,null,r.a.createElement(R.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))}}]),a}(n.Component),V=U.a.create({name:"normal_login"})(J),Y=a(167),q=a(491),z=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={current:"Machine"},e.handleClick=function(t){console.log("click ",t),e.setState({current:t.key})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.user,n=e.location,i=this.state.current;return r.a.createElement("div",null,r.a.createElement(Y.a,{onClick:this.handleClick,selectedKeys:[i],mode:"horizontal"},r.a.createElement(Y.a.Item,{key:"Machine",icon:r.a.createElement(q.a,null)}," Machine Status"),r.a.createElement(Y.a.Item,{key:"User",icon:r.a.createElement(q.a,null)}," User Status"),r.a.createElement(Y.a.Item,{key:"Location",icon:r.a.createElement(q.a,null)}," Location ")),function(e){switch(e){case"Machine":return r.a.createElement(w,{data:t});case"User":return r.a.createElement(v,{user:a});case"Location":return r.a.createElement(N,{location:n});default:return r.a.createElement(w,{data:t})}}(i))}}]),a}(n.Component),W=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).getLogin=function(){return e.props.isLoggedIn?r.a.createElement(K.a,{to:"/home"}):r.a.createElement(V,{handleLoginSucceed:e.props.handleLoginSucceed})},e.getMachine=function(){return e.props.isLoggedIn?r.a.createElement(z,{data:e.props.data,user:e.props.user,location:e.props.location}):r.a.createElement(K.a,{to:"/login"})},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"main"},r.a.createElement(M.a,null,r.a.createElement(_.a,{path:"/login",render:this.getLogin}),r.a.createElement(_.a,{path:"/home",render:this.getMachine}),r.a.createElement(_.a,{render:this.getLogin})),r.a.createElement("p",{className:"footnote"},"Sparkling Laundry Management, Mailing Address: admin@foxmail.com, LMA 2020 Project"))}}]),a}(n.Component),G=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={data:[],user:[],location:[],isLoggedIn:Boolean(localStorage.getItem("TOKEN_KEY"))},e.handleLoginSucceed=function(t){console.log("token --- ",t),localStorage.setItem("TOKEN_KEY",t),e.setState({isLoggedIn:!0})},e.handleLogout=function(){localStorage.removeItem("TOKEN_KEY"),e.setState({isLoggedIn:!1})},e.getMachineFromDb=function(){fetch("/api/machines").then((function(e){return e.json()})).then((function(t){return e.setState({data:t.machines})}))},e.getUserFromDb=function(){fetch("/api/users").then((function(e){return e.json()})).then((function(t){return e.setState({user:t.users})}))},e.getLocationFromDb=function(){fetch("/api/locations").then((function(e){return e.json()})).then((function(t){return e.setState({location:t.locations})}))},e.putDataToDB=function(e){},e.deleteFromDB=function(e){},e.updateDB=function(e,t){},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getMachineFromDb(),this.getUserFromDb(),this.getLocationFromDb()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(P,{handleLogout:this.handleLogout,isLoggedIn:this.state.isLoggedIn}),r.a.createElement(W,{handleLoginSucceed:this.handleLoginSucceed,isLoggedIn:this.state.isLoggedIn,data:this.state.data,user:this.state.user,location:this.state.location}))}}]),a}(n.Component),H=a(495);c.a.render(r.a.createElement(H.a,null,r.a.createElement(G,null)),document.getElementById("root"))}},[[246,1,2]]]);
//# sourceMappingURL=main.7165adc7.chunk.js.map