(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{156:function(e,t,a){e.exports=a.p+"static/media/logo.aafc7e68.png"},189:function(e,t,a){e.exports=a(341)},194:function(e,t,a){},195:function(e,t,a){},196:function(e,t,a){},210:function(e,t,a){},336:function(e,t,a){},337:function(e,t,a){},341:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),c=a(11),r=a.n(c),l=(a(194),a(48)),o=(a(195),a(156)),u=a.n(o),s=(a(196),a(360)),m=a(42),d=function(e){var t=e.user,a=e.logout;return i.a.createElement("div",{className:"App-header"},i.a.createElement("div",{className:"logo"},i.a.createElement("img",{src:u.a,alt:""})),i.a.createElement("span",{className:"App-title"},"Sparkling Admin Console"),i.a.createElement("div",{className:"logout"},t.token?i.a.createElement(m.a,{icon:i.a.createElement(s.a,null),onClick:a,type:"primary"},"Logout"):null))},f=a(355),p=a(358),E=a(359),b=a(348),h=(a(210),a(142),a(43)),g=a(347),y="http://lmapp.us-east-2.elasticbeanstalk.com/api",v=function(){var e=Object(n.useState)(),t=Object(l.a)(e,2),a=t[0],c=t[1];Object(n.useEffect)((function(){Object(h.a)("".concat(y,"/users")).then((function(e){var t=e.users;c(t)}))}),[]);var r=[{title:"RegisterDate",dataIndex:"registerDate",key:"date",render:function(e){return new Date(e).toLocaleString()}},{title:"FirstName",dataIndex:"firstName",key:"firstName"},{title:"LastName",dataIndex:"lastName",key:"lastName"},{title:"Email",dataIndex:"email",key:"email"},{title:"LocationID",dataIndex:"locationID",key:"locationID"}];return i.a.createElement(g.a,{columns:r,dataSource:a,rowKey:"email"})},k=a(80),j=a.n(k),O=a(107),S=a(82),T=a(49),x=a(168),I=a(169),R=a(184),N=a(182),C=a(185),P=a(353),w=a(352),A=a(351),D=a(357),L=function(e){var t=e.editing,a=e.dataIndex,n=e.title,c=e.inputType,r=(e.record,e.index,e.children),l=Object(C.a)(e,["editing","dataIndex","title","inputType","record","index","children"]),o="number"===c?i.a.createElement(P.a,null):i.a.createElement(w.a,null);return i.a.createElement("td",l,t?i.a.createElement(A.a.Item,{name:a,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(n,"!")}]},o):r)},_=function(e){Object(R.a)(a,e);var t=Object(N.a)(a);function a(e){var n;Object(x.a)(this,a),(n=t.call(this,e)).formRef=i.a.createRef(),n.edit=function(e){n.formRef.current.setFieldsValue(Object(T.a)({name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:""},e)),n.setState({editingKey:e._id})},n.isEditing=function(e){return e._id===n.state.editingKey},n.cancel=function(){var e=n.state.dataSource,t=e.pop();"VirtualID"===t._id?n.setState({editingKey:"",dataSource:Object(S.a)(e),count:n.state.count-1}):(e.push(t),n.setState({editingKey:""}))},n.save=function(){var e=Object(O.a)(j.a.mark((function e(t){var a,i,c,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.formRef.current.validateFields();case 3:a=e.sent,i=Object(S.a)(n.state.dataSource),(c=i.findIndex((function(e){return e._id===t})))>-1?(r=i[c],i.splice(c,1,Object(T.a)(Object(T.a)({},r),a)),"VirtualID"===t?n.handleAdd(i[c]):n.handleSave(i[c]),n.setState({dataSource:i,editingKey:""})):n.setState({dataSource:i,editingKey:""}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),n.handleSave=function(e){n.state.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations/".concat(e._id),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(e){return e.isSuccess})).catch((function(e){return console.log(e)}))},n.handleDelete=function(e){var t=n.state,a=t.count,i=t.dataSource;fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations/".concat(e),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then((function(e){return e.json()})).then((function(){return n.setState({dataSource:i.filter((function(t){return t._id!==e})),count:a-1})})).catch((function(e){return console.log(e)}))},n.onAdd=function(){var e=n.state,t=e.count,a=e.dataSource,i={name:"",email:"",defaultRunningTime:"",defaultReservationExpireTime:"",defaultPickupTime:"",_id:"VirtualID"};n.setState({dataSource:[].concat(Object(S.a)(a),[i]),count:t+1}),n.edit(i)},n.handleAdd=function(e){fetch("http://lmapp.us-east-2.elasticbeanstalk.com/api/locations",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:e.name,email:e.email,defaultRunningTime:e.defaultRunningTime,defaultReservationExpireTime:e.defaultReservationExpireTime,defaultPickupTime:e.defaultPickupTime})}).then((function(e){return e.json()})).then((function(t){return t.isSuccess&&(e._id=t.id),t.isSuccess})).catch((function(e){return console.log(e)}))},n.state={dataSource:[],count:0,editingKey:""};i.a.createRef();return n.columns=[{title:"Name",dataIndex:"name",key:"name",editable:!0},{title:"Email",dataIndex:"email",key:"email",editable:!0},{title:"DefaultRunningTime",dataIndex:"defaultRunningTime",key:"defaultRunningTime",editable:!0},{title:"DefaultReservationExpireTime",dataIndex:"defaultReservationExpireTime",key:"defaultReservationExpireTime",editable:!0},{title:"DefaultPickupTime",dataIndex:"defaultPickupTime",key:"defaultPickupTime",editable:!0},{title:"",key:"delete",render:function(e,t){return n.state.dataSource.length>=1?i.a.createElement(D.a,{title:"Sure to delete?",onConfirm:function(){return n.handleDelete(t._id)}},i.a.createElement("a",null,"Delete")):null}},{title:"",key:"edit",render:function(e,t){return n.isEditing(t)?i.a.createElement("span",null,i.a.createElement("a",{onClick:function(){return n.save(t._id)},style:{marginRight:8}},"Save"),i.a.createElement(D.a,{title:"Sure to cancel?",onConfirm:n.cancel},i.a.createElement("a",null,"Cancel"))):i.a.createElement("a",{disabled:""!==n.state.editingKey,onClick:function(){return n.edit(t)}},"Edit")}}],n}return Object(I.a)(a,[{key:"componentDidMount",value:function(){var e=this;Object(h.a)("".concat(y,"/locations")).then((function(t){var a=t.locations;e.setState({dataSource:a,count:a.length})}))}},{key:"render",value:function(){var e=this,t=(this.state.dataSource,this.columns.map((function(t){return t.editable?Object(T.a)(Object(T.a)({},t),{},{onCell:function(a){return{record:a,inputType:"name"===t.dataIndex||"email"===t.dataIndex?"text":"number",dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(a)}}}):t})));return i.a.createElement("div",null,i.a.createElement(m.a,{disabled:""!==this.state.editingKey,onClick:this.onAdd,type:"primary",style:{marginTop:16,marginBottom:16}},"Add a New Location"),i.a.createElement(A.a,{ref:this.formRef,component:!1},i.a.createElement(g.a,{components:{body:{cell:L}},bordered:!0,rowKey:"_id",dataSource:this.state.dataSource,columns:t,rowClassName:"editable-row",pagination:{onChange:this.cancel}})))}}]),a}(n.Component),K=a(91),U=a(343),q=a(344),F=a(350),M=a(349),V=a(345),J=a(346),B=a(112),z=a(354),G=a(361),H=a(362),Q=a(129),W=K.a.Option,X=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),o=Object(l.a)(r,2),u=o[0],s=o[1],d=Object(n.useState)({}),f=Object(l.a)(d,2),p=f[0],E=f[1],b=Object(n.useState)([]),v=Object(l.a)(b,2),k=(v[0],v[1]),x=Object(n.useState)([]),I=Object(l.a)(x,2),R=I[0],N=I[1],C=Object(n.useState)(0),w=Object(l.a)(C,2),L=w[0],_=w[1],X=Object(Q.a)(),Y=Object(l.a)(X,1)[0];Object(n.useEffect)((function(){Object(h.a)("".concat(y,"/users")).then((function(e){var t=e.users;k(t)})),Object(h.a)("".concat(y,"/locations")).then((function(e){var t=e.locations;N(t)}))}),[]),Object(n.useEffect)((function(){Object(O.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)("".concat(y,"/machines"));case 2:t=e.sent,a=t.machines,c(Object(S.a)(a.reverse()));case 5:case"end":return e.stop()}}),e)})))()}),[L]),Object(n.useEffect)((function(){Y.resetFields()}),[p]);var Z=[{title:"Serial Number",dataIndex:"sn",key:"sn",editable:!0},{title:"Location Name",dataIndex:"locationName",key:"locationName",editable:!0,sorter:function(e,t){return e.locationName.localeCompare(t.locationName)}},{title:"Start time",dataIndex:"startTime",key:"startTime",editable:!0,render:function(e){return new Date(e).toLocaleString()}},{title:"Available",dataIndex:"isAvailable",key:"isAvailable",editable:!0,render:function(e){return e?i.a.createElement(G.a,{twoToneColor:"#52c41a"}):i.a.createElement(H.a,{twoToneColor:"#eb2f96"})}},{title:"Reserved",dataIndex:"isReserved",key:"isReserved",editable:!0,render:function(e){return e?i.a.createElement(G.a,{twoToneColor:"#52c41a"}):i.a.createElement(H.a,{twoToneColor:"#eb2f96"})}},{title:"Picked up",dataIndex:"isPickedUp",key:"isPickedUp",editable:!0,render:function(e){return e?i.a.createElement(G.a,{twoToneColor:"#52c41a"}):i.a.createElement(H.a,{twoToneColor:"#eb2f96"})}},{title:"Type",dataIndex:"machineType",key:"machineType",editable:!0},{title:"Actions",key:"op",render:function(e,t){return i.a.createElement(U.a,{size:"small"},i.a.createElement(m.a,{type:"link",onClick:function(){s(!0),E(t)}},"edit"),i.a.createElement(q.a,{type:"vertical"}),i.a.createElement(D.a,{title:"Sure to delete?",onConfirm:function(){Object(h.a)("".concat(y,"/machines/").concat(t._id),{method:"DELETE"}).then((function(e){F.a.success({message:e.msg,description:"Deleted"}),_(L+1)})).catch((function(e){F.a.success({message:e.msg,description:e})}))}},i.a.createElement(m.a,{danger:!0,type:"link"},"delete")))}}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,{type:"primary",style:{marginTop:16,marginBottom:16},onClick:function(){E({}),s(!0)}},"Add a machine"),i.a.createElement(g.a,{columns:Z,dataSource:a,rowKey:"_id"}),i.a.createElement(M.a,{title:"Add/Modify machine",visible:u,closable:!0,width:720,mask:!0,maskClosable:!0,onClose:function(){s(!1),E({})},footer:i.a.createElement("div",{style:{textAlign:"right"}},i.a.createElement(m.a,{onClick:function(){return s(!1)},style:{marginRight:8}},"Cancel"),i.a.createElement(m.a,{onClick:function(){return Y.submit()},type:"primary"},"Submit"))},i.a.createElement(A.a,{layout:"vertical",form:Y,initialValues:p,onFinish:function(e){p._id?Object(h.a)("".concat(y,"/machines/").concat(p._id),{method:"PUT",data:Object(T.a)({},e)}).then((function(e){F.a.success({message:e.msg,description:"Updated"}),_(L+1)})):Object(h.a)("".concat(y,"/machines"),{method:"POST",data:Object(T.a)({},e)}).then((function(e){_(L+1)})),E({}),s(!1)}},i.a.createElement(V.a,{gutter:16},i.a.createElement(J.a,{span:12},i.a.createElement(A.a.Item,{label:"Serial Number",name:"sn",required:!0},i.a.createElement(P.a,null))),i.a.createElement(J.a,{span:12},i.a.createElement(A.a.Item,{required:!0,label:"Type",name:"machineType"},i.a.createElement(B.a.Group,null,i.a.createElement(B.a,{value:"washer"},"washer"),i.a.createElement(B.a,{value:"dryer"},"dryer"))))),i.a.createElement(V.a,{gutter:16},i.a.createElement(J.a,{span:8},i.a.createElement(A.a.Item,{required:!0,label:"isAvailable",name:"isAvailable",valuePropName:"checked"},i.a.createElement(z.a,null))),i.a.createElement(J.a,{span:8},i.a.createElement(A.a.Item,{required:!0,label:"isReserved",name:"isReserved",valuePropName:"checked"},i.a.createElement(z.a,null))),i.a.createElement(J.a,{span:8},i.a.createElement(A.a.Item,{required:!0,label:"isPickedUp",name:"isPickedUp",valuePropName:"checked"},i.a.createElement(z.a,null)))),i.a.createElement(A.a.Item,{required:!0,label:"Location",name:"locationID"},i.a.createElement(K.a,null,R.map((function(e){return i.a.createElement(W,{key:e._id,value:e._id},e.name)})))))))},Y=b.a.TabPane,Z=function(e){return i.a.createElement("div",{className:"contents"},i.a.createElement(b.a,{defaultActiveKey:"1",centered:!0,size:"large"},i.a.createElement(Y,{tab:"Machines",key:"1"},i.a.createElement(X,null)),i.a.createElement(Y,{tab:"Users",key:"2"},i.a.createElement(v,null)),i.a.createElement(Y,{tab:"Locations",key:"3"},i.a.createElement(_,null))))},$=a(363),ee=a(364),te=(a(336),function(e){var t=e.setUser;return i.a.createElement(A.a,{className:"login-form",onFinish:function(e){Object(h.a)("".concat(y,"/admin/login"),{method:"POST",data:Object(T.a)({},e)}).then((function(a){if("true"===a.isSuccess){var n=a.token,i=a.msg;t(Object(T.a)({token:n},e)),F.a.success({description:"Redirecting...",duration:1.5,message:i})}else{var c=a.msg;F.a.error({description:"Login failed",message:c})}})).catch((function(e){F.a.error({description:"Login error",message:e})}))}},i.a.createElement("p",{className:"login-title"},"Admin Login"),i.a.createElement(A.a.Item,{name:"username",rules:[{required:!0,message:"Please input your username!"}]},i.a.createElement(w.a,{prefix:i.a.createElement($.a,null),placeholder:"Username"})),i.a.createElement(A.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}]},i.a.createElement(w.a,{prefix:i.a.createElement(ee.a,null),type:"password",placeholder:"Password"})),i.a.createElement(A.a.Item,null,i.a.createElement(m.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))}),ae=(a(337),function(e){var t=e.user,a=function(){return t.token?i.a.createElement(f.a,{to:"/home"}):i.a.createElement(te,e)};return i.a.createElement("div",{className:"main"},i.a.createElement(p.a,null,i.a.createElement(E.a,{path:"/login",render:a}),i.a.createElement(E.a,{path:"/home",render:function(){return t.token?i.a.createElement(Z,null):i.a.createElement(f.a,{to:"/login"})}}),i.a.createElement(E.a,{render:a})))}),ne=function(){var e=Object(n.useState)({}),t=Object(l.a)(e,2),a=t[0],c=t[1];return i.a.createElement("div",{className:"App"},i.a.createElement(d,{user:a,logout:function(){c({})}}),i.a.createElement(ae,{user:a,setUser:c}),i.a.createElement("div",{className:"footer"},"Sparkling Laundry Management, Mailing Address: admin@foxmail.com, LMA 2020 Project"))},ie=a(356);r.a.render(i.a.createElement(ie.a,null,i.a.createElement(ne,null)),document.getElementById("root"))}},[[189,1,2]]]);
//# sourceMappingURL=main.a650b388.chunk.js.map